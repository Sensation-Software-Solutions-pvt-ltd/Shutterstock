# Shutterstock-like Image Marketplace â€” System Architecture (GCP Edition)

> **Version:** 1.2 Â· **Date:** 2026-02-18 Â· **Scale Target:** 5M+ images, 10K RPM search Â· **Stack:** Google Cloud Platform (GCP)

---

## ğŸš€ Implementation Roadmap (3 Pillars)

### [Step 1: Image Ingestion (Batch Migration)](./BATCH_INGESTION_WORKFLOW.md)

* **Goal:** Processing 5M+ local images into **Google Cloud Storage (GCS)**.
* **Key Tech:** Python, Vertex AI (Vision), Cloud SQL (pgvector).

### [Step 2: Search Engine (Vertex AI Search Integration)](./VERTEX_AI_SEARCH_INTEGRATION.md)

* **Goal:** Enabling conceptual "Semantic" search + Keyword search.
* **Key Tech:** Vertex AI Search, Vector Search (Matching Engine).

### [Step 3: Triple-Portal Website Development](./WEBSITE_DEVELOPMENT.md)

* **Goal:** Launching the **Public**, **Contributor**, and **Admin** portals on **Cloud Run**.
* **Key Tech:** Next.js, Stripe, Google Cloud Identity Platform.

### [Project Roadmap: Development Phases](./DEVELOPMENT_ROADMAP.md)

* **Phased Build:** 6 phases from Foundation/Migration to Global Scaling.
* **Priority:** Search and Data integrity before frontend expansion.

---

## 1. High-Level Integrated Architecture (GCP)

```text
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚         Google Cloud CDN / Load Balancer    â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â–¼                               â–¼                              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    Public Site     â”‚          â”‚ Contributor Panel  â”‚          â”‚    Admin Panel     â”‚
    â”‚  (Next.js on Run)  â”‚          â”‚  (Next.js on Run)  â”‚          â”‚  (Next.js on Run)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                               â”‚                               â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                          â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚         Unified Backend (Cloud Run)         â”‚
                          â”‚   (JWT Auth, RBAC, Rate Limiting, Logic)    â”‚
                          â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚      â”‚      â”‚      â”‚      â”‚      â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚      â”‚      â”‚      â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â–¼                     â–¼      â”‚      â–¼      â–¼                     â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚Identity Platform â”‚  â”‚ Cloud Pub/Subâ”‚  â”‚ â”‚ Vertex AI    â”‚  â”‚ Payment Gateway  â”‚
   â”‚ (Firebase Auth)  â”‚  â”‚ (Messaging)  â”‚  â”‚ â”‚ Search      â”‚  â”‚ (Stripe)         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚         â”‚
                                â–¼         â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚          â”‚   Cloud Storage (GCS)    â”‚
                   â”‚  Image Processor   â”‚ â”‚          â”‚                          â”‚
                   â”‚ (Cloud Functions)  â”‚ â”‚          â”‚  /originals  (private)   â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚          â”‚  /thumbnails (public)    â”‚
                            â”‚             â”‚          â”‚  /watermarked (public)   â”‚
                            â–¼             â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                   â”‚  Vertex AI Vision  â”‚ â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  (Tagging/Embed)   â”‚â—„â”˜          â”‚   Cloud SQL (Postgres)   â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚   (Primary Metadata)     â”‚
                                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Integrated Feature Matrix

| Pillar | Public (Buyer) | Contributor (Artist) | Admin (Staff) |
| :--- | :--- | :--- | :--- |
| **Search** | Semantic (Vertex AI) | Portfolio Management | Moderation Queue |
| **Commerce** | Stripe Checkout | Stripe Connect Payouts | Platform Revenue Ops |
| **Content** | GCS Signed URLs | Direct GCS Upload (V4) | Content Governance |
| **Access** | Identity Platform | RBAC: Contributor | RBAC: Admin |

---

## 3. Data Infrastructure (GCP)

### 3.1 Metadata Storage (Cloud SQL for PostgreSQL)

The source of truth for all relational data. Uses `pgvector` for local vector operations and Vertex AI Matching Engine for large-scale similarity.

### 3.2 Search Index (Vertex AI Search)

The high-performance discovery engine. Uses **Hybrid Search** (combining keyword and vector search) for ultra-relevant results.

### 3.3 Object Storage (Google Cloud Storage)

* **Standard Class:** Watermarked previews and thumbnails for fast delivery.
* **Coldline/Archive:** Original raw files to optimize costs.

---

## 4. Scalability & Security (GCP)

* **Cloud Run:** Serverless scaling of all three portals and the backend API.
* **Cloud IAM + RBAC:** Strict permission boundaries using Google Cloud Identity.
* **Cloud Armor:** Edge security to protect against DDoS and OWASP top 10.
* **VPC Service Controls:** Ensuring data exfiltration protection between SQL and GCS.
